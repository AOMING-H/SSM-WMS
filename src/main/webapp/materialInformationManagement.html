<!DOCTYPE html>
<html>

	<!--<head>
		<meta charset="utf-8">
		<link rel="stylesheet" type="text/css" href="css/font-awesome.min.css">
		<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
		<link rel="stylesheet" type="text/css" href="css/bootstrap-table.min.css">

		<script type="text/javascript" src="libs/jquery/2.1.1/jquery.min.js"></script>
		<script type="text/javascript" src="libs/popper/popper.min.js"></script>
		<script type="text/javascript" src="libs/bootstrap/4.0.0/bootstrap.min.js"></script>
		<script type="text/javascript" src="libs/bootstrap/4.0.0/bootstrap-table.min.js"></script>
		<script type="text/javascript" src="libs/bootstrap/4.0.0/bootstrap-table-zh-CN.min.js"></script>
		<script type="text/javascript" src="libs/model/common.js"></script>
	</head>-->

	<body>
		<div id="container" class="container">
			<div id="toolbar" class="btn-group" role="group" aria-label="操作">
				<button id="add" type="button" class="fa fa-plus btn btn-primary"> 新增</button>
				<button id="edit" type="button" class="fa fa-edit btn btn-secondary"> 编辑</button>
				<button id="remove" type="button" class="fa fa-trash btn btn-danger"> 删除</button>
				<button id="remove" type="button" class="fa fa-search-plus btn btn-primary"> 高级搜索</button>
			</div>
			<table 
				id="table" 
				data-toolbar="#toolbar" 
				data-search="true" 
				data-show-refresh="true" 
				data-show-columns="true" 
				data-striped="true" 
				data-minimum-count-columns="2" 
				data-pagination="true" 
				data-id-field="id" 
				data-page-list="[10, 25, 50, 100, ALL]" 
				data-side-pagination="server" 
				data-response-handler="responseHandler">
			</table>
		</div>
		
		<script>
			var $table = $('#table'),
				$remove = $('#remove'),
				selections = [];

			function initTable() {
				$table.bootstrapTable({
					url: url_base_materials,  //请求后台的URL（*）
					method: 'get', //请求方式（*）
					queryParams: queryParams, //传递参数（*）
					queryParamsType: "limit", //参数格式,发送标准的RESTFul类型的参数请求  
					pageNumber: 1, //初始化加载第一页，默认第一页
					pageSize: 10, //每页的记录行数（*）
					contentType: "application/x-www-form-urlencoded",
					clickToSelect: true, //是否启用点击选中行
					columns: [{
							field: 'state',
							checkbox: true,
							align: 'center',
							valign: 'middle'
						},
						{
							field: 'id',
							title: 'ID',
							sortable: true,
							align: 'center'
						},
						{
							field: 'materialNo',
							title: '料号',
							sortable: true,
							align: 'center'
						}, {
							field: 'name',
							title: '名称',
							sortable: true,
							align: 'center'
						}, {
							field: 'category',
							title: '类别',
							sortable: true,
							align: 'center'
						}, {
							field: 'unit',
							title: '计量单位',
							sortable: true,
							align: 'center'
						}, {
							field: 'storageLife',
							title: '保存期(小时)',
							sortable: true,
							align: 'center'
						}, {
							field: 'specifications',
							title: '规格',
							sortable: true,
							align: 'center'
						}, {
							field: 'description',
							title: '描述',
							sortable: true,
							align: 'center'
						}, {
							field: 'updateTime',
							title: '更新时间',
							sortable: true,
							align: 'center',
							formatter: function (value, row, index) {
					            if (value == null) {
					                return "";
					            }
					            var time = new Date(value).toLocaleDateString();
					            return time;
					        }
						}
					]
				});
			}

			function queryParams(params) {
				var temp = { //这里的键的名字和控制器的变量名必须一直，这边改动，控制器也需要改成一样的
					//limit: params.limit, //页面大小
					//offset: params.offset
					//pageNumber: 1,
					//pageSize: 10
					pageSize: params.limit,   //页面大小  
				    pageNumber: params.offset,  //页码  
				    sort: params.sort,  //排序列名  
				    sortOrder: params.order//排位命令（desc，asc）  
				};
				return temp;
			}
			
			function responseHandler(res) {
				var table = {
                   	"total": res.data.total,	//总页数
                    "rows": res.data.dataList   //数据
                };
				$.each(table.rows, function(i, row) {
					row.state = $.inArray(row.id, selections) !== -1;
				});
				return table;
			}

			$(function() {
				initTable();
			});
		</script>

	</body>

</html>